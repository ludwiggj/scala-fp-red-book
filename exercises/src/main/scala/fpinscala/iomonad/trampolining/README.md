Based on https://medium.com/@olxc/trampolining-and-stack-safety-in-scala-d8e86474ddfa